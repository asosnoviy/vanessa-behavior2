<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"><html><head><meta content="text/html;charset=utf-8" http-equiv="content-type"></meta><link rel="stylesheet" type="text/css" href="v8help://service_book/service_style"></link><meta name="GENERATOR" content="MSHTML 11.00.9600.18739"></meta></head><body>
<p><font size="3" face="Arial">Vanessa-Behavior - это фреймворк для разработки в 1С используя методологию BDD.</font></p>
<p><font size="3" face="Arial">Страница проекта: <a href="https://github.com/silverbulleters/vanessa-behavior">https://github.com/silverbulleters/vanessa-behavior</a></font></p>
<p><font size="3" face="Arial">Vanessa-Behavior является аналогом Cucumber для разработки на платформе 1С:Предприятие.</font></p>
<p><font size="2" face="Arial">Поддерживаются версии платформы:</font></p>
<blockquote style="MARGIN-RIGHT: 0px" dir="ltr">
<p><font size="1" face="Arial"> 8.2.19, 8.3.6, 8.3.7, 8.3.8, 8.3.9, 8.3.10.</font></p></blockquote>
<p><font size="2" face="Arial">У обработки есть <strong>Управляемая форма</strong> (она является основой) и <strong>Обычная форма</strong>.</font></p>
<blockquote style="MARGIN-RIGHT: 0px" dir="ltr">
<p><font size="1" face="Arial">Обычная форма поддерживается в <strong>ограниченном</strong> формате. Т.е. ошибки исправляются - новые фичи добавляются редко. Но вы можете добавить в неё нужные Вам фичи самостоятельно.</font></p></blockquote>
<p><font size="2" face="Arial"></font> </p>
<p><font size="3" face="Arial"></font> </p>
<p><font size="3" face="Arial">Разделы справки:</font></p>
<p>1 . <a href="#ПравилаНаписанияfeatureФайлов">Правила написания feature файлов.</a></p>
<blockquote style="MARGIN-RIGHT: 0px" dir="ltr">
<p><a href="#Основные секции feature файла.">1.1 Основные секции feature файла.</a></p>
<blockquote style="MARGIN-RIGHT: 0px" dir="ltr">
<p><a href="#Заголовок">1.1.1 Заголовок feature</a></p>
<p><a href="#Сценарии">1.1.2 Сценарии</a></p>
<p><a href="#Структура сценария">1.1.3 Структура сценария</a></p></blockquote>
<p dir="ltr"><a href="#Тег @tree">#Тег @tree</a></p>
<p><a href="#Тег @exportscenarios">#Тег @exportscenarios</a></p>
<p>1.4 Передача в шаг таблицы.</p>
<p>1.5 Вызов структуры сценария как вложенного сценария.</p>
<p>1.6 Передача параметра таблицы (таблиц) во вложенный сценарий.</p></blockquote>
<p dir="ltr">2. <a href="#Как загрузить feature файл.">Как загрузить feature файл. Тэги.</a></p>
<p>3. <a href="#Как запустить feature файл на выполнение. Отладка.">Как запустить feature файл на выполнение. Отладка.</a></p>
<p>4. <a href="#Как создать epf файл на основе feature файла.">Как создать epf файл на основе feature файла.</a></p>
<p>5. Описание настроек на закладке Сервис.</p>
<p>6. Асинхронные вызовы</p>
<p>7. Как получить отчет Allure, jUnit, Cucmber report.</p>
<p><a href="#Быстрое создание файла сценария">8. Как накликать фича файл.</a></p>
<p>9. Как получить состояние формы TestClient.</p>
<p>10. Как подключить свою библиотеку.</p>
<p>11. Как поделиться своими шагами с коллегами при групповой разработке.</p>
<p>12. Как создать автоинструкцию в формате HTML, MD.</p>
<p>13. Как создать автовидеоинструкцию.</p>
<p>14. Список экспортных процедур и функций.</p>
<p>15. Запуск Vanessa-Behavior на CI.</p>
<p>16. Инструкция для контрибьютерров.</p>
<p> </p>
<p> </p>
<p><a name="ПравилаНаписанияfeatureФайлов"><font size="4">1 . Правила написания feature файлов.</font></a></p>
<p><font size="2"><a name="Основные секции feature файла."><strong>1.1 Основные секции feature файла.</strong></a></font></p>
<blockquote style="MARGIN-RIGHT: 0px" dir="ltr">
<p><font size="1">Feature файл должен быть написан на языке <strong>Gherkin</strong>.</font></p>
<p>Feature файл содержит в себе две основные секции - это заголовок фичи и её сценарии.</p>
<p align="center"><strong><font size="5"><a name="Заголовок">Заголовок</a></font>.</strong></p>
<p>Заголовок фичи содержит в себе служебную секцию с директивой, указывающей на язык (русский, английский и т.д.) фичи.</p>
<p align="center"><img src="_files/Директива.png"></img></p>
<p>Далее в заголовке обычно идут теги, которые относятся ко всей фиче (ещё бывают теги, которые относятся к конкретному сценарию).</p>
<p align="center"><img src="_files/Теги.png"></img></p>
<p>Далее идёт часть, в которой используется ключевое слово <strong>Функционал</strong> или <strong>Функциональность </strong>и далее идёт название фичи.</p>
<p align="center"><img src="_files/ИмяФичи.png"></img></p>
<p>Далее идёт часть, в которой коротко даётся ответ на три вопроса: кто хочет, что он хочет и зачем это надо (бизнес польза).</p>
<p align="center"><img src="_files/КтоЧтоЗачем.png"></img></p>
<p>Далее идёт необязательная секция <strong>Контекст</strong>. В ней обычно описывают шаги, которые подготавливают выполнения сценария, но непосредственно к нему не относятся.</p>
<p>В одном feature файле может быть много сценариев, и секция <strong>Контекст</strong> будет выполняться перед каждым сценарием.</p>
<p align="center"><img src="_files/Контекст.png"></img></p>
<p> </p>
<p>Далее идёт часть, в которой могут располагаться либо простые сценарии, либо сценарии специального формата, которые в русском переводе "<strong>Scenario Outline"</strong> получили название "<strong>Структура сценария"</strong>.</p>
<p> </p>
<p align="center"><font size="5"><strong><a name="Сценарии">Сценарии</a></strong></font>.</p>
<p>Обычный сценарий начинается с ключевого слова "<strong>Сценарий:</strong>", затем идёт имя сценария.</p>
<p align="center"><img src="_files/ИмяСценария.png"></img></p>
<p> </p>
<p>Далее идут шаги сценария. Каждый шаг должен начинаться с ключевого слова, такого как <strong>Дано</strong>, <strong>Когда</strong>, <strong>Тогда</strong>, <strong>И</strong>, <strong>Затем</strong> и т.д.</p>
<p>Полный список ключевых слов для каждого языка можно посмотреть здесь: <a href="https://github.com/cucumber/gherkin/blob/master/gherkin-languages.json#L2372">https://github.com/cucumber/gherkin/blob/master/gherkin-languages.json#L2372</a></p>
<p>Ограничений на количество использований ключевых слов шагов нет. </p>
<p align="center"><img src="_files/Шаги.png"></img></p>
<p>У шагов могут быть параметры простых типов - число, строка, дата.</p>
<p dir="ltr">Числа записываются как есть.</p>
<blockquote style="MARGIN-RIGHT: 0px" dir="ltr">
<p align="center"><img src="_files/Числа.png"></img></p>
<p> </p></blockquote>
<p dir="ltr">Даты могут быть указаны в двух форматах</p>
<blockquote style="MARGIN-RIGHT: 0px" dir="ltr">
<p align="center"><img src="_files/Даты.png"></img></p></blockquote>
<p dir="ltr">Строки должны быть заключены либо в апострофы, либо в кавычки.</p>
<blockquote style="MARGIN-RIGHT: 0px" dir="ltr">
<p align="center"><img src="_files/Строки2.png"></img></p></blockquote>
<p> </p>
<p><font size="2"><strong>Для строк действуют правила экранирования спецсимволов.</strong></font></p>
<p><font size="2"><strong>\' - означает апостроф</strong></font></p>
<p><font size="2"><strong>\" - означает кавычку</strong></font></p>
<p><font size="2"><strong>\\ - означает одинарный слеш (\)</strong></font></p>
<p align="center"><img src="_files/Апостроф.png"></img></p>
<p> </p>
<p align="center"><strong><font size="5"><a name="Структура сценария">Структура сценария</a></font></strong></p><font size="1">
<p dir="ltr">Структура сценария допускает, что некоторые параметры в шагах указываются в специальных скобках.</p>
<p dir="ltr">Такие параметры должны быть описаны в таблице, которая идёт после структуры сценария и начинается с ключевого слова <strong>"Примеры"</strong>.</p>
<p dir="ltr">Таким образом, для каждой строки таблицы <strong>Примеров</strong> будет выполнен <strong>свой</strong> сценарий со <strong>своим</strong> набором параметров.</p>
<p dir="ltr" align="center"><img src="_files/Outline01.png"></img></p></font>
<p align="center"><strong><font size="5"></font></strong> </p>
<p align="center"><strong><font size="5"></font></strong> </p>
<p> </p></blockquote>
<p dir="ltr"><a name="Тег @tree"><font size="2"><strong>1.2 Тег @tree</strong></font></a></p>
<blockquote style="MARGIN-RIGHT: 0px" dir="ltr">
<p>Vanessa-Behavior умеет работать с <strong>расширенным</strong> синтаксисом языка сценариев <strong>Gherkin</strong>. Назовём его <strong>Turbo Gherkin</strong>.</p>
<p>Если в заголовке фичи указан тег <strong>@tree</strong>, тогда парсер фич будет особым образом интерпретировать отступы (символы Tab, пробелы недопустимы!!!) в тексте.</p>
<p>Шаги будут образовывать дерево шагов. Т.е. шаги с большим значением отступа будут считаться вложенными. Как в python.</p>
<p>Это помогает структурировать текст feature файла.</p>
<p align="center"><img src="_files/tree.png" width="1160" height="258"></img></p>
<p> </p>
<p align="center"><img src="_files/tree2.png"></img></p>
<p> </p>
<p>Таким образом, часть шагов оказалась внутри других шагов. Шаг, который является веткой дерева (выделен рамкой на картинке) - выполняться не будет.</p>
<p> </p></blockquote>
<p dir="ltr"><a name="Тег @exportscenarios"><font size="2"><strong>1.3 Тег @exportscenarios</strong></font></a></p>
<blockquote style="MARGIN-RIGHT: 0px" dir="ltr">
<p>Если в заголовке фичи указан тег @exportscenarios, тогда становится возможным вызывать один сценарий из другого (и передавать в него свои параметры).</p>
<p>Например, есть такой сценарий, содержащий шаг <strong>"Когда Я открываю Visual Studio Code"</strong>:</p>
<p align="center"><img src="_files/export01.png"></img></p>
<p align="left">И рядом с ним (или в подчиненном каталоге, или в каталоге библиотек) лежит другой feature файл, у которого указан тег <strong>@exportscenarios</strong> и в нём есть сценарий с именем <strong>"Я открываю Visual studio code"</strong>.</p>
<p align="center"><img src="_files/export02.png"></img></p>
<p align="left">Тогда если загрузить первый сценарий в Vanessa-Behavior - шаг <strong>"Когда Я открываю Visual Studio Code" </strong>загрузится как ветка дерева.</p>
<p align="center"><img src="_files/export03.png"></img></p>
<p align="left"> </p>
<p align="left">Чтобы передать обычный параметр в подчиненный сценарий - надо чтобы строка с именем сценария содержала параметры. Например, есть вот такой сценарий:</p>
<p align="center"><img src="_files/export05.png"></img></p>
<p align="left">В него можно передать свой параметр <strong>"ИмяФайла"</strong>. </p>
<p align="center"><img src="_files/export06.png"></img></p>
<p align="left"> </p>
<p align="left">Тогда в Vanessa-Behavior это отобразится вот так:</p>
<p align="center"><img src="_files/export07.png"></img></p>
<p align="left"> </p>
<p align="left"> </p>
<p align="left"><font size="2"><strong>2. <a name="Как загрузить feature файл.">Как загрузить feature файл. Тэги.</a></strong></font></p>
<blockquote style="MARGIN-RIGHT: 0px" dir="ltr">
<p align="left"><font size="1">Vanessa-Behavior позволяет загрузить либо один feature файл (Ctrl+F2), либо feature файлы из каталога (Alt+F2).</font></p>
<p align="center"><img src="_files/LoadFeature01.png"></img></p>
<p align="left">Если выбран пункт "Загрузить один файл" - тогда feature файл будет загружен, не смотря на наличие в нём тегов.</p>
<p align="left">Если выбран пункт "Загрузить файлы из каталога" - тогда возможны варианты, в зависимости от указанных тегов в настройках Vanessa-Behavior.</p>
<p align="center"><img src="_files/Tags01.png"></img></p>
<p align="left">Если заполнен список "Список исключаемых тэгов" - тогда если в feature файле указан такой тэг в заголовке feature, весь feature файл не будет загружен. Если тэг был указан у одного или нескольких сценариев, <br>данные сценарии не будет загружены, а остальные загрузятся.</p>
<p align="left">Если заполнен список "Тэги для запуска" - тогда если в feature данный тэг не встречается нигде - весь feature файл будет проигнорирован. Если тэг есть в заголовке feature, тогда будут загружены все сценарии из feature.<br>Если тэг указан у одного или нескольких сценариев - тогда будут загружены только эти сценарии.<br><br></p></blockquote>
<p dir="ltr" align="left"><strong><font size="2">3. <a name="Как запустить feature файл на выполнение. Отладка.">Как запустить feature файл на выполнение. Отладка.</a></font></strong></p>
<blockquote style="MARGIN-RIGHT: 0px" dir="ltr">
<p dir="ltr" align="left"><font size="1">Что выполнить все сценарии надо нажать на кнопку "<strong>Выполнить сценарии</strong>".</font></p>
<p dir="ltr" align="left"><font size="1">Если вы внесли изменения в epf или в фичу, тогда надо нажать на кнопку "<strong>Перезагрузить сценарии</strong>". Иначе будут использоваться старые версии фич и обработок.</font></p>
<p dir="ltr" align="left"><font size="1">При постоянном внесении правок в фичу или в epf - удобно использовать кнопку "<strong>Перезагрузить и выполнить</strong>".</font></p>
<p dir="ltr" align="left"><font size="1">Также в Vanessa-Behavior можно использовать следующие варианты запуска фич на выполнение (доступно в контекстном меню):</font></p>
<p dir="ltr" align="center"><img src="_files/debug01.png"></img></p>
<blockquote style="MARGIN-RIGHT: 0px" dir="ltr">
<p dir="ltr" align="left"><font size="1">1. <strong>Выполнить данный сценарий с текущего шага</strong> (Ctrl+F5). Позволяет выполнить сценарий с текущего шага и до конца данного сценария. Другие сценарии выполняться не будут.</font></p>
<p dir="ltr" align="left"><font size="1">2. <strong>Выполнить данный сценарий с текущего шага с продолжением</strong> (Ctrl+Shift+F5). Позволяет выполнить сценарий с текущего шага. Также будут выполнены сценарии, следующие за данным.</font></p>
<p dir="ltr" align="left"><font size="1">3. <strong>Выполнить данный сценарий с начала</strong> (Alt+F5).  Будет выполнен только данный сценарий начиная с первого шага.</font></p>
<p dir="ltr" align="left"><font size="1">4. <strong>Перезагрузить и выполнить данный сценарий </strong>(Alt+F6).  Будут перечитаны данные фича файлов, epf файлов и будет выполнен только данный сценарий, начиная с первого шага.</font></p>
<p dir="ltr" align="left"><font size="1">5. <strong>Выполнить сценарии этой фичи</strong> (Ctrl+Alt+F5). Будут выполнены все сценарии данной фичи.</font></p>
<p dir="ltr" align="left"><font size="1">6. <strong>Выполнить один шаг</strong> (F11). Будет выполнен только один шаг фичи. Можно выбрать любой шаг в дереве фич и выполнить его, включая шаги секции Контекст. Удобно использовать при отладке.</font></p>
<p dir="ltr" align="left"><font size="1">7. <strong>Открыть feature файл в редакторе</strong>. Откроет приложение, которое ассоциировано с расширением <strong>feature</strong>.</font></p>
<p dir="ltr" align="left"><font size="1">8. <strong>Открыть каталог feature</strong>. Откроет проводник с каталогом, где лежит feature файл.</font></p>
<p dir="ltr" align="left"><font size="1">9. <strong>Выполнять сценарий с этого шага с сохранением контекстов</strong>. Будет выполнен сценарий с текущего шага. При этом будет выставлен флаг <strong>Сохранять контексты перед выполнением шагов</strong> на закладке <strong>Сервис</strong>, т.е. при выполнении сценария будут запоминаться значения контекстов шагов. При таком режиме запуска удобно делать отладку сценария, когда шаги зависят от значений переменных <strong>Контекст</strong> и <strong>КонтекстСохраняемый</strong>. При первом запуске сценария с данной опцией возможно выполнение сценария с начала, если флаг <strong>Сохранять контексты перед выполнением шагов</strong> ранее не был равен <strong>Истина</strong>. При последующих запусках сценарий будет выполняться с нужного шага.</font></p>
<p dir="ltr" align="left"><font size="1">10. <strong>Свернуть до фич</strong>. Дерево фич будет свёрнуто до строк фич.</font></p>
<p dir="ltr" align="left"><font size="1">11. <strong>Свернуть до сценариев</strong>. Дерево фич будет свёрнуто до строк сценариев.</font></p>
<p dir="ltr" align="center"><img src="_files/Run04.png"></img></p>
<p dir="ltr" align="left"><font size="1">12. <strong>Брейкпоинт</strong> (F9). У строки шага будет установлена отметка брейкпоинта. Выполнение сценариев будет прервано на этом шаге, при этом сам шаг выполнен не будет. Далее удобно выполнять отладку по одному шагу (F11).</font></p>
<p dir="ltr" align="left"><font size="1">13. <strong>Убрать все брейкпоинты</strong> (Ctrl+F9). Убирает все брейкпоинты из дерева.</font></p></blockquote>
<p dir="ltr" align="left"><font size="1"></font> </p>
<p dir="ltr" align="left"><font size="1"></font> </p>
<p dir="ltr" align="left"><font size="1"></font> </p></blockquote>
<p dir="ltr" align="left"><font size="3"><strong>4. <a name="Как создать epf файл на основе feature файла.">Как создать epf файл на основе feature файла.</a></strong></font></p>
<blockquote style="MARGIN-RIGHT: 0px" dir="ltr">
<p dir="ltr" align="center"><font size="1"><img src="_files/Gen05.png"></img></font></p>
<blockquote style="MARGIN-RIGHT: 0px" dir="ltr">
<p dir="ltr" align="left"><font size="1">1. Если мы работаем в режиме управляемых форм - надо выставить флаг "<strong>Генерировать управляемую форму</strong>".</font></p>
<p dir="ltr" align="left"><font size="1">2. Если выставить флаг "<strong>Создавать области при генерации кода</strong>"  - внутри epf будут созданы области кода.</font></p>
<p dir="ltr" align="center"><img src="_files/Gen03.png"></img></p>
<p dir="ltr" align="left">3.  Флаг "<strong>Создавать закомментированный код для переиспользуемых процедур</strong>" сейчас не используется.</p>
<p dir="ltr" align="left">4. Флаг "<strong>Выводить текст получаемого модуля, вместо перегенерации EPF</strong>" - позволяет вывести модуль в текстовый документ, не создавая epf.</p>
<p dir="ltr" align="left">5. Если epf уже существует, тогда в неё будут добавлены новые шаги. При этом существующие процедуры, функции, макеты и т.д. в epf сохранятся.</p>
<p dir="ltr" align="left">6. Epf будет создана с тем же именем файла, что и feature файл.</p>
<p dir="ltr" align="left">7. EPF создаётся с помощью штатных средств платформы. В поле "<strong>Версия платформы для генерации EPF</strong>" надо указать путь к каталогу <strong>bin</strong> нужной версии платформы 8.3.10 или выше.</p>
<p dir="ltr" align="left">8. Epf будет создана в каталоге "<strong>step_definitions</strong>", который будет находится в каталоге feature файла.</p>
<p dir="ltr" align="left">9. Каждая epf должная обладать уникальным значением в поле "<strong>Имя</strong>".  Если вы копируете (а не перемещаете) epf в другой каталог, тогда надо обеспечить уникальность этого поля.</p>
<p dir="ltr" align="center"><img src="_files/Gen04.png"></img></p></blockquote></blockquote>
<p dir="ltr" align="left"><strong><font size="3"></font></strong> </p>
<p dir="ltr" align="left"><strong><font size="3"></font></strong> </p>
<h2><a name="Быстрое создание файла сценария">8. Быстрое создание файла сценария</a></h2>
<h3>Запись поведения пользователя</h3>
<p>1. На вкладке «Работа с UI» имеется набор кнопок, отвечающих за взаимодействие с клиентом тестирования из Vanessa Behavior.</p>
<p>«Подключит TestClient» - запуск клиента тестирования</p>
<p>«Начать запись поведения» - запуск клиента тестирования и начало запись журнала действий пользователя.</p>
<p>«Закончить запись поведения» - останавливает запись журнала действий пользователя и производит автоматическую конвертацию в сценарий на языке Gherkin.</p>
<p align="center"><img id="Рисунок 10" src="_files/image001.jpg" width="624" height="414"></img></p>
<h3>Создание сценария через запись действий пользователя.</h3>
<p>Используя данную последовательность шагов удобно просить сотрудников компании воспроизвести ошибку в конфигурации или порядок рабочий действий для создания фичи и уменьшения технического долга.</p>
<p>1.На рабочем месте пользователя запускаем конфигурацию в режиме предприятия с установленным параметром запуска <strong>/UILogRecorder</strong></p>
<p align="center"><img id="Рисунок 2" src="_files/image002.png" width="458" height="448"></img></p>
<p>2. Нажимаем «Начать запись»</p>
<p align="center"><img id="Рисунок 3" src="_files/image003.png" width="493" height="69"></img></p>
<p>3. Просим пользователя воспроизвести последовательность действий и по окончании нажимаем кнопку «Завершить»</p>
<p align="center"><img id="Рисунок 4" src="_files/image004.jpg" width="492" height="82"></img></p>
<p>4. Откроется файл журнала действий пользователя, который необходимо сохранить и передать разработчику</p>
<p align="center"><img id="Рисунок 1" src="_files/image005.jpg" width="539" height="285"></img></p>
<p>5. В дальнейшем для получения сценария на языке Gherkin необходимо в обработке Vanessa Behavior перейти на вкладку «Работа с UI -&gt; Исходный XML». Вставить содержимое журнала действий пользователя в соответствующее окно.</p>
<p> </p>
<p align="center"><img id="Рисунок 5" src="_files/image006.jpg" width="624" height="414"></img></p>
<p>Нажать кнопку «Преобразовать исходный XML» и получить готовый сценарий.</p>
<p align="center"><img id="Рисунок 6" src="_files/image007.jpg" width="624" height="414"></img></p>
<p>В дальнейшем полученный сценарий нужно отредактировать – заполнив описательную часть сценария.</p>
<h3>Используя каталог известных шагов</h3>
<p>Для добавления шагов в сценарий достаточно нажать кнопку «Добавить известные шаги» и добавить нужный функционал сценария двойным кликом мышки на нужной строке.</p>
<p align="center"><img id="Рисунок 7" src="_files/image008.jpg" width="624" height="414"></img></p>
<h3>Запуск воспроизведения полученного сценария</h3>
<p>1. Сохраняем полученный сценарий и запускаем так, как описано в разделе <a href="#Как загрузить feature файл.">Как загрузить feature файл. Тэги.</a></p>
<p>2. Для быстрой проверки корректности сценария нажимаем кнопку «Подготовить сценарий к выполнению». В этом случае произойдет загрузка сценария аналогично использованию команды «Загрузить фичи -&gt; Загрузить один файл»</p>
<p><span style="BACKGROUND: yellow"><b>Внимание. </b>Полученный сценарий сохраняется в файл во временной директории операционной системы. В случае использования функции «<a href="#Как создать epf файл на основе feature файла.">Генерация EPF</a>», полученная таким образом обработка сохраниться рядом с файлом фичи.</span></p></blockquote></body></html>